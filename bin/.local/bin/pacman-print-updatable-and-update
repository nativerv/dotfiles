#!/bin/sh

figlet -f slant System Upgrade

updatable="$(unbuffer pacman -Qu)"
updatable_count="$(echo "${updatable}" | wc -l)"
updatable_count="$((updatable_count - 1))"

echo
echo "Updatable packages (${updatable_count}): "

if [ "${updatable_count}" -ne '0' ]; then
  echo "${updatable}" | pr -2 -t -o 20 | xargs -I{} printf '  '{}'\n'
else
  echo "  No packages is updatable at the moment."
fi

if [ "${updatable_count}" = '0' ]; then
  echo 'Executing [1;32msudo pacman -Syu[0m...'
  echo
  sudo pacman -Syu
else
  echo
  echo "Press any key to continue..."
  read -r ""
fi
