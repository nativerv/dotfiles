#!/bin/sh

# The famous "get a menu of emojis to copy" script.

EMOJI_FILE="${XDG_DATA_HOME:-$HOME/.local/share}/dmenu_unicode/emoji"

dmenu_prompt='Copy emoji:'
type_mode='false'

while getopts t option; do
  case "${option}" in
	  t)	dmenu_prompt="Paste emoji:"
        type_mode='true'
        ;;
	[?])	print >&2 "usage: $0 [-t]"; exit 1 ;;
	esac
done
shift $((OPTIND - 1))

# Get user selection via dmenu from emoji file.
chosen=$(cut -d ';' -f1 "${EMOJI_FILE}" | dmenu -p "${dmenu_prompt:-Emoji}" -i -l 30 | sed "s/ .*//")

# Exit if none chosen.
[ -z "$chosen" ] && exit

# If you run this command with an argument, it will automatically insert the
# character. Otherwise, show a message that the emoji has been copied.
if [ "${type_mode}" = "true" ]; then
	xdotool type "${chosen}"
else
	printf "${chosen}" | xclip -selection clipboard
	notify-send "'${chosen}' copied to clipboard." &
fi
